trigger:
  - main

pool:
  vmImage: 'macOS-latest'

jobs:
  - job: Build
    displayName: 'Build job'
    steps:

      - task: JavaToolInstaller@0
        inputs:
          versionSpec: '17'
          jdkArchitectureOption: 'x64'
          jdkSourceOption: 'PreInstalled'

      - task: Gradle@2
        displayName: 'Building Project'
        continueOnError: false
        inputs:
            workingDirectory: ''
            gradleWrapperFile: 'gradlew'
            gradleOptions: '-Xmx3072m'
            publishJUnitResults: false
            tasks: assembleDebug
            codeCoverageToolOption: 'None'
            javaHomeOption: 'JDKVersion'
            jdkVersionOption: 'default'
            jdkArchitectureOption: 'x64'
            checkStyleRunAnalysis: false
            findBugsRunAnalysis: false

  - script: |
      echo "Build location: $(Build.SourcesDirectory)"
      displayName: 'Show Build Location'
  - script: |
      ./gradlew appDistributionUploadRelease
      displayName: 'Upload APK to Firebase App Distribution'
      env:
      FIREBASE_TOKEN: $(FIREBASE_TOKEN)
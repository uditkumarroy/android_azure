trigger:
  - main

pool:
  vmImage: 'macOS-latest'

jobs:
  - job: Build
    displayName: 'Build job'
    steps:

      - task: JavaToolInstaller@0
        inputs:
          versionSpec: '17'
          jdkArchitectureOption: 'x64'
          jdkSourceOption: 'PreInstalled'

      - task: Gradle@2
        displayName: 'Building Project'
        continueOnError: false
        inputs:
          workingDirectory: ''
          gradleWrapperFile: 'gradlew'
          gradleOptions: '-Xmx3072m'
          publishJUnitResults: false
          tasks: assembleDebug
          codeCoverageToolOption: 'None'
          javaHomeOption: 'JDKVersion'
          jdkVersionOption: 'default'
          jdkArchitectureOption: 'x64'
          checkStyleRunAnalysis: false
          findBugsRunAnalysis: false

      - script: |
          echo "APK file location: $(Build.SourcesDirectory)/app/build/outputs/apk/debug/app-debug.apk"
        displayName: 'Show APK File Location'

      - script: |
          firebase login:ci --no-localhost --token "1//0gb8tXttQVMPnCgYIARAAGBASNwF-L9Ir77z3rFy7t1oS1IW9Pd77KqmNMRcZlHuKjqonxlTvuiLciHdIf2q0h5tdTsEbYPgt2QM"
          firebase appdistribution:distribute path/to/your/apk/file.apk --app your-firebase-app-id --groups your-distribution-group
        displayName: 'Authenticate Firebase and Upload APK to Firebase App Distribution'
